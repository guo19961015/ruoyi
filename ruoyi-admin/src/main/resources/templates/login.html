<!DOCTYPE html>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <title>é„‚å°”å¤šæ–¯å¸‚ä¸­å°ä¼ä¸šå¹³å°å…¬å…±æœåŠ¡å¹³å°[[${version}]]</title>
    <meta name="description" content="è‹¥ä¾åå°ç®¡ç†æ¡†æ¶,é—²é¹¿å·¥ä½œæµ">
    <link href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link href="../static/css/font-awesome.min.css" th:href="@{/css/font-awesome.min.css}" rel="stylesheet"/>
    <link href="../static/css/style.css" th:href="@{/css/style.css}" rel="stylesheet"/>
    <link href="../static/css/login.min.css" th:href="@{/css/login.min.css}" rel="stylesheet"/>
    <link href="../static/ruoyi/css/ry-ui.css" th:href="@{/ruoyi/css/ry-ui.css?v=4.0.0}" rel="stylesheet"/>
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
    <link rel="shortcut icon" href="../static/favicon.ico" th:href="@{favicon.ico}"/>
    <style type="text/css">
        label.error { position:inherit;  }
        body { font-size: 16px; }
    </style>
    <script>
        if(window.top!==window.self){window.top.location=window.location};
    </script>
</head>

<body class="signin" >

<div class="signinpanel">
    <div class="row">
        <div class="col-sm-7">
            <div class="signin-info">
                <div class="logopanel m-b">
                    <h1><!--<img alt="[ é„‚å°”å¤šæ–¯å¸‚ä¸­å°ä¼ä¸šå…¬å…±æœåŠ¡å¹³å° ]" src="../static/ruoyi.png" th:src="@{/ruoyi.png}">--></h1>
                </div>
                <div class="m-b"></div>
                <h1 style="text-align: center;font-size: 42px;">é„‚å°”å¤šæ–¯å¸‚</br>ä¸­å°ä¼ä¸šå…¬å…±æœåŠ¡å¹³å°</h1>
                <!--<ul class="m-b">
                    <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> &lt;!&ndash;Activiti 6.x&ndash;&gt;</li>
                    <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> &lt;!&ndash;SpringBoot 2.x&ndash;&gt;</li>
                    <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> &lt;!&ndash;Thymeleaf 3.x&ndash;&gt;</li>
                    <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> &lt;!&ndash;Bootstrap 3.x&ndash;&gt;</li>
                </ul>-->
               <!-- <div style="color: black;">
                    <h4>æµç¨‹ç”¨æˆ·å’Œç”¨æˆ·ç»„ (å¯†ç å‡ä¸ºè´¦æˆ·å)ï¼š</h4>
                    <ol>
                        <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>æ™®é€šä¼ä¸šç”¨æˆ·ï¼štest11</li>
                        <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>æ——åŒºå®¡æ‰¹ç”¨æˆ·ï¼štest12</li>
                        <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>æ‹…ä¿å®¡æ‰¹ç”¨æˆ·ï¼štest13</li>
                        <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>é“¶è¡Œå®¡æ‰¹ç”¨æˆ·ï¼štest14</li>
                        <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>å¸‚çº§å†³ç­–å§”å‘˜ä¼šç”¨æˆ·ï¼štest15</li>
                        <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>é“¶è¡Œæ”¾æ¬¾ç”¨æˆ·ï¼štest16</li>

                    </ol>
                    <h4>p.s. æµç¨‹ç®¡ç†è¯·ä½¿ç”¨ admin è´¦å·ç»´æŠ¤</h4>
                </div>-->
            </div>
        </div>
        <div class="col-sm-5">
            <form id="signupForm">
                <input id="bankId" name="bankId" type="hidden" th:value="${bankId}"   />
                <input id="productId" name="productId" type="hidden" th:value="${productId}"   />
                <h4 class="no-margins">ç™»å½•ï¼š</h4>
                <p class="m-t-md"><!--ä½ è‹¥ä¸ç¦»ä¸å¼ƒï¼Œæˆ‘å¿…ç”Ÿæ­»ç›¸ä¾--></p>
                <input type="text"     name="username" class="form-control uname"     placeholder="ç”¨æˆ·å"     />
                <input type="password" name="password" class="form-control pword"     placeholder="å¯†ç "  />
                <div class="row m-t" th:if="${captchaEnabled==true}">
                    <div class="col-xs-6">
                        <input type="text" name="validateCode" class="form-control code" placeholder="éªŒè¯ç " maxlength="5" autocomplete="off">
                    </div>
                    <div class="col-xs-6">
                        <a href="javascript:void(0);" title="ç‚¹å‡»æ›´æ¢éªŒè¯ç ">
                            <img th:src="@{captcha/captchaImage(type=${captchaType})}" class="imgcode" width="85%"/>
                        </a>
                    </div>
                </div>
                <div class="checkbox-custom" th:classappend="${captchaEnabled==false} ? 'm-t'">
                    <input type="checkbox" id="rememberme" name="rememberme"> <label for="rememberme">è®°ä½æˆ‘</label>
                </div>
                <div class="left" >
                    <a th:href="@{/register}"><span style="color: red;">ç«‹å³æ³¨å†Œ</span></a>

                </div>
                <!--<div class="right" >
                    <a th:href="@{/register}"><span style="color: red;">æœåŠ¡æœºæ„æ³¨å†Œ</span></a>
                </div>-->
                <button class="btn btn-success btn-block" id="btnSubmit" data-loading="æ­£åœ¨éªŒè¯ç™»å½•ï¼Œè¯·ç¨å...">ç™»å½•</button>
            </form>
        </div>
    </div>
    <!--<div class="signup-footer">
        <div class="pull-left">
            &copy; 2019 All Rights Reserved. RuoYi, made with <a href="https://gitee.com/calvinhwang123/RuoYi-Process" target="_blank">ä¸€åªé—²é¹¿ ğŸ¦Œ</a>.<br>
        </div>
    </div>-->
</div>
<script th:inline="javascript"> var ctx = [[@{/}]]; var captchaType = [[${captchaType}]]; </script>
<!-- å…¨å±€js -->
<script src="../static/js/jquery.min.js" th:src="@{/js/jquery.min.js}"></script>
<script src="../static/js/bootstrap.min.js" th:src="@{/js/bootstrap.min.js}"></script>
<!-- éªŒè¯æ’ä»¶ -->
<script src="../static/ajax/libs/validate/jquery.validate.min.js" th:src="@{/ajax/libs/validate/jquery.validate.min.js}"></script>
<script src="../static/ajax/libs/validate/messages_zh.min.js" th:src="@{/ajax/libs/validate/messages_zh.min.js}"></script>
<script src="../static/ajax/libs/layer/layer.min.js" th:src="@{/ajax/libs/layer/layer.min.js}"></script>
<script src="../static/ajax/libs/blockUI/jquery.blockUI.js" th:src="@{/ajax/libs/blockUI/jquery.blockUI.js}"></script>
<script src="../static/ruoyi/js/ry-ui.js" th:src="@{/ruoyi/js/ry-ui.js?v=4.0.0}"></script>
<script>
    $(function() {
        validateKickout();
        validateRule();
        $('.imgcode').click(function() {
            var url = ctx + "captcha/captchaImage?type=" + captchaType + "&s=" + Math.random();
            $(".imgcode").attr("src", url);
        });
    });

    $.validator.setDefaults({
        submitHandler: function() {
            login();
        }
    });

    function login() {
        $.modal.loading($("#btnSubmit").data("loading"));
        var username = $.common.trim($("input[name='username']").val());
        var password = $.common.trim($("input[name='password']").val());
        var validateCode = $("input[name='validateCode']").val();
        var bankId = $('#bankId').val();
        var productId = $('#productId').val();
        console.log(bankId+"---"+productId);
        var rememberMe = $("input[name='rememberme']").is(':checked');
        $.ajax({
            type: "post",
            url: ctx + "login",
            data: {
                "username": username,
                "password": password,
                "bankId" :bankId,
                "productId" :productId,
                "validateCode": validateCode,
                "rememberMe": rememberMe
            },
            success: function(r) {
                if (r.code == 0) {
                    location.href = ctx + 'index?bankId='+bankId+'&productId='+productId;
                } else {
                    $.modal.closeLoading();
                    $('.imgcode').click();
                    $(".code").val("");
                    $.modal.msg(r.msg);
                }
            }
        });
    }

    function validateRule() {
        var icon = "<i class='fa fa-times-circle'></i> ";
        $("#signupForm").validate({
            rules: {
                username: {
                    required: true
                },
                password: {
                    required: true
                }
            },
            messages: {
                username: {
                    required: icon + "è¯·è¾“å…¥æ‚¨çš„ç”¨æˆ·å",
                },
                password: {
                    required: icon + "è¯·è¾“å…¥æ‚¨çš„å¯†ç ",
                }
            }
        })
    }

    function validateKickout() {
        if (getParam("kickout") == 1) {
            layer.alert("<font color='red'>æ‚¨å·²åœ¨åˆ«å¤„ç™»å½•ï¼Œè¯·æ‚¨ä¿®æ”¹å¯†ç æˆ–é‡æ–°ç™»å½•</font>", {
                    icon: 0,
                    title: "ç³»ç»Ÿæç¤º"
                },
                function(index) {
                    //å…³é—­å¼¹çª—
                    layer.close(index);
                    if (top != self) {
                        top.location = self.location;
                    } else {
                        varÂ urlÂ  = Â location.search;
                        if (url) {
                            varÂ oldUrlÂ  = window.location.href;
                            varÂ newUrlÂ  = oldUrl.substring(0, Â oldUrl.indexOf('?'));
                            self.locationÂ  = newUrl;
                        }
                    }
                });
        }
    }

    function getParam(paramName) {
        var reg = new RegExp("(^|&)" + paramName + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return decodeURI(r[2]);
        return null;
    }
</script>
</body>
</html>
